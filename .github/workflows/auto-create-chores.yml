name: Auto-Create Recurring Chores

on:
  schedule:
    # Run every day at midnight GMT+7 (5 PM UTC previous day)
    - cron: '0 17 * * *'
  workflow_dispatch: # Allow manual triggering

jobs:
  create-chores:
    runs-on: ubuntu-latest
    
    steps:
      - name: Call auto-create-recurring-chores webhook
        run: |
          curl -X GET "${{ secrets.VERCEL_URL }}/api/webhooks/auto-create-recurring-chores" \
            -H "x-webhook-secret: ${{ secrets.SUPABASE_WEBHOOK_SECRET }}" \
            -H "Content-Type: application/json" \
            --fail-with-body \
            --verbose
        
      - name: Check webhook response
        if: failure()
        run: echo "Webhook call failed. Check the logs above for details."
